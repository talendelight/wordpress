{
  "version": "3.5.0",
  "release_date": "2026-01-26",
  "status": "completed",
  "description": "Security hardening: Block /wp-admin/ for non-Administrator roles (PENG-053) + Phase 0 policy documentation + Environment configuration + Upload handler",
  "steps": [
    {
      "type": "deploy_code",
      "source": "wp-content",
      "target": "public_html/wp-content",
      "exclusions_file": ".hostingerignore",
      "description": "Deploy wp-content directory with automatic exclusions",
      "notes": "Includes automated td-env-config.php deployment via mu-plugins location"
    },
    {
      "type": "clear_cache",
      "method": "litespeed",
      "verify_command": "curl -I https://talendelight.com | grep 'x-litespeed-cache'"
    },
    {
      "type": "verify_env_config",
      "file": "wp-content/mu-plugins/td-env-config.php",
      "verify_command": "ls -la wp-content/mu-plugins/td-env-config.php && wp eval 'echo defined(\"TD_PERSON_REGISTRATION_FORM_ID\") ? \"OK\" : \"MISSING\";'",
      "description": "Verify env config automatically loaded from mu-plugins"
    },
    {
      "type": "deploy_database",
      "config": {
        "sql_files": []
      },
      "description": "No database changes in this release",
      "notes": "Add SQL filenames to config.sql_files array when database changes are needed"
    }
  ],
  "features": [
    {
      "task_id": "PENG-053",
      "title": "Block /wp-admin/ for non-Administrator roles",
      "description": "Critical security hardening - only Administrator role can access WordPress admin panel",
      "implementation": "wp-content/plugins/talendelight-roles/talendelight-roles.php v1.1.0",
      "documentation": "docs/PENG-053-WPADMIN-BLOCK-IMPLEMENTATION.md",
      "dependencies": ["BMSL-001"],
      "completed": "2026-01-25"
    },
    {
      "task_id": "BMSL-001",
      "title": "Role Capabilities Matrix",
      "description": "Define role capabilities and access boundaries for all 5 custom roles",
      "implementation": "docs/ROLE-CAPABILITIES-MATRIX.md",
      "documentation": "docs/ROLE-CAPABILITIES-MATRIX.md",
      "completed": "2026-01-24"
    },
    {
      "task_id": "PENG-001",
      "title": "CandidateID Strategy",
      "description": "Define unique identifier system (TD-YYYY-NNNN) for cross-system tracking",
      "implementation": "docs/PENG-001-CANDIDATEID-STRATEGY.md",
      "documentation": "docs/PENG-001-CANDIDATEID-STRATEGY.md",
      "completed": "2026-01-25",
      "notes": "Implementation in PENG-016 (Phase 1)"
    },
    {
      "task_id": "COPS-001",
      "title": "CV Lifecycle Policy",
      "description": "Define CV storage, archiving, and deletion policies for GDPR compliance",
      "implementation": "docs/COPS-001-CV-LIFECYCLE-POLICY.md",
      "documentation": "docs/COPS-001-CV-LIFECYCLE-POLICY.md",
      "completed": "2026-01-25"
    },
    {
      "task_id": "INFR-ENV",
      "title": "Environment Configuration (td-env-config.php)",
      "description": "Deploy environment-specific configuration as mu-plugin for automatic loading",
      "implementation": "wp-content/mu-plugins/td-env-config.php",
      "completed": "2026-01-26",
      "notes": "Defines TD_PERSON_REGISTRATION_FORM_ID and other env-specific constants"
    },
    {
      "task_id": "INFR-UPLOAD",
      "title": "Forminator Upload Handler",
      "description": "Custom file upload handler for Forminator forms with per-form directory logic",
      "implementation": "wp-content/plugins/forminator-upload-handler/",
      "completed": "2026-01-26",
      "notes": "Activated on production - handles CV uploads to /uploads/people/"
    }
  ],
  "verification": {
    "steps": [
      {
        "description": "Test Administrator can access /wp-admin/",
        "command": "Login as admin → Navigate to /wp-admin/ → Should see dashboard"
      },
      {
        "description": "Test Manager blocked from /wp-admin/",
        "command": "Login as Manager → Navigate to /wp-admin/ → Should redirect to /managers/?access_denied=wp-admin"
      },
      {
        "description": "Test Operator blocked from /wp-admin/",
        "command": "Login as Operator → Navigate to /wp-admin/ → Should redirect to /operators/?access_denied=wp-admin"
      },
      {
        "description": "Verify admin bar hidden for non-Administrators",
        "command": "Login as Manager/Operator → No black admin bar at top"
      },
      {
        "description": "Check security audit logs",
        "command": "wp-content/debug.log should contain: 'TalenDelight Security: Blocked wp-admin access for user...'"
      },
      {
        "description": "Verify td-env-config.php is loaded",
        "command": "SSH: wp eval 'echo defined(\"TD_PERSON_REGISTRATION_FORM_ID\") ? \"TD_PERSON_REGISTRATION_FORM_ID = \" . TD_PERSON_REGISTRATION_FORM_ID : \"NOT LOADED\";' --path=/home/u909075950/domains/talendelight.com/public_html"
      },
      {
        "description": "Verify forminator-upload-handler is active",
        "command": "SSH: wp plugin list --path=/home/u909075950/domains/talendelight.com/public_html | grep forminator-upload-handler"
      },
      {
        "description": "Test file upload moves to correct directory",
        "command": "Submit Person Registration Form (ID 80) with CV → Check /wp-content/uploads/people/ for uploaded file"
      }
    ]
  },
  "rollback": {
    "steps": [
      {
        "description": "Revert main branch to v3.4.0 tag if critical issues arise"
      }
    ]
  }
}
